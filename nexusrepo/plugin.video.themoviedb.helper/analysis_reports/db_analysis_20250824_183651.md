# TMDbHelper Database Query Analysis Report

## Analysis Overview

This report identifies database query patterns and optimization opportunities in the TMDbHelper codebase.

### File: resources/language/cleaner.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 2
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
41-                    if line.startswith(z_string):
42-                        z_line = x
43-                        break
44-
45-                try:
46:                    skip_range = [i for i in range(a_line, z_line)]
47-                except TypeError:  # Failure to get a line
48-                    print(f'{file}\nFAILED: {a_number} {a_line} {z_line}')
49-                    continue
50-
51-                print(f'{file}\nDELETE: {skip_range}')
52-                with open(file, 'w', encoding="utf8") as f:
53:                    for x, line in enumerate(lines):
54-                        if x not in skip_range:
55-                            f.write(line)
56-
57-            except FileNotFoundError:
58-                continue

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/modules/tmdbhelper_lib/__init__.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 2
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/plugin.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/script.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/service.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/addon/consts.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/addon/dialog.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 6
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/addon/logger.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/addon/module.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/addon/permissions.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/addon/plugin.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/addon/thread.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/addon/tmdate.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/api_keys/fanarttv.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/api_keys/mdblist.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/api_keys/omdb.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/api_keys/tmdb.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/api_keys/tokenhandler.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/api_keys/trakt.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/api_keys/tvdb.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/contains.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/fanarttv/api.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/kodi/mapping.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/api/kodi/rpc.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/mapping.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 6
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
78-                        continue
79-                # Run through type conversion
80-                if 'type' in d:
--
84-                    v = d['func'](v, *d.get('args', []), **d.get('kwargs', {}))
85-                # Check not empty
86-                if not v and v != 0:
87-                    continue
88-                # Map value onto item dict parent/child keys
89:                for p, c in d['keys']:
90-                    if c == UPDATE_BASEKEY:
91-                        item[p].update(v)
92-                        continue
93-                    if c is None:
94-                        item[p] = v

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/api/mdblist/api.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/omdb/api.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/omdb/mapping.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/api/request.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 2
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
- üîó Contains connection management code
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/tmdb/api.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/tmdb/images.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/tmdb/mapping.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/api/tmdb/userauthenticator.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 4
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/tmdb/users.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 1
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/trakt/api.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 3
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/trakt/authenticator.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 3
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/trakt/items.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/trakt/sync/activity.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/trakt/sync/datasync.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 1
- UPDATE statements: 0
0
- DELETE statements: 5
- execute() calls: 0
0
- fetchone() calls: 1
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üîó Contains connection management code
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/trakt/sync/datatype.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 10
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/trakt/sync/itemdata.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/trakt/sync/itemlist.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/trakt/sync/property_mixins.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/trakt/token.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 5
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/tvdb/api.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/api/tvdb/mapping.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/files/bcache.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/files/dbdata.py

**Query Counts:**
- SELECT statements: 6
- INSERT statements: 10
- UPDATE statements: 12
- DELETE statements: 8
- execute() calls: 15
- fetchone() calls: 2
- fetchall() calls: 1

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
102-    def database_execute(self, connection, query, data=None):
--
124-    def database_tables(self):
125-        return {}
126-
127-    def create_database_execute(self, connection):
128-        def create_column_data(columns):
129:            return [f'{k} {v["data"]}' for k, v in columns.items()]
130-        
131-        def create_column_fkey(columns):
132:            return [f'FOREIGN KEY({k}) REFERENCES {v["foreign_key"]} ON DELETE CASCADE' for k, v in columns.items() if 'foreign_key' in v]
133-
134-        def create_column_uids(columns):
135:            keys = [k for k, v in columns.items() if v.get('unique')]
136-            return [f'UNIQUE ({", ".join(keys)})'] if keys else []
137-
138-        cursor = connection.cursor()
139-        this_database_version = cursor.execute("PRAGMA user_version").fetchone()[0]
140-
141-        if this_database_version and this_database_version < self.database_version:
142:            for version, changes in self.database_changes.items():
143-                if version <= this_database_version: continue
144:                for query in changes:
145-                    try: cursor.execute(query)
146:                    except Exception as error: self.kodi_log(f'CACHE: Exception while initializing _database: {error}\n{self._sc_name} - {query}', 1)
147-
148:        for table, columns in self.database_tables.items():
149-            query_parts = create_column_data(columns) + create_column_fkey(columns) + create_column_uids(columns)
150-            query = f'CREATE TABLE IF NOT EXISTS {table}({", ".join(query_parts)})'
151-            try: cursor.execute(query)
152:            except Exception as error: self.kodi_log(f'CACHE: Exception while initializing _database: {error}\n{self._sc_name} - {query}', 1)
153-
154:        for table, columns in self.database_tables.items():
155:            for column, v in columns.items():
156-                if not v.get('indexed'): continue
157-                query = f'CREATE INDEX IF NOT EXISTS {table}_{column}_x ON {table}({column})'
158-                try: cursor.execute(query)
159:                except Exception as error: self.kodi_log(f'CACHE: Exception while initializing _database: {error}\n{self._sc_name} - {query}', 1)
160-
161-        if this_database_version < self.database_version:
162-            try:
163-                query = f"PRAGMA user_version = {self.database_version}"
164-                cursor.execute(query)
165:            except Exception as error: self.kodi_log(f'CACHE: Exception while initializing _database: {error}\n{self._sc_name} - {query}', 1)
166-
167-        return connection
168-
169-
170-class DatabaseStatements:
171-    @staticmethod
172-    def insert_or_ignore(table, keys=('id',)):
173:        return f"INSERT OR IGNORE INTO {table}({', '.join(keys)}) VALUES ({', '.join(['?' for _ in keys])})"
174-
175-    @staticmethod
176-    def insert_or_replace(table, keys=('id',)):
177:        return f"INSERT OR REPLACE INTO {table}({', '.join(keys)}) VALUES ({', '.join(['?' for _ in keys])})"
178-
179-    @staticmethod
180-    def insert_or_update_if_null(table, keys=('id',), conflict_constraint='id'):
181:        update_keys = ', '.join([f'{k}=ifnull({k},excluded.{k})' for k in keys])
182:        return f"INSERT INTO {table}({', '.join(keys)}) VALUES ({', '.join(['?' for _ in keys])}) ON CONFLICT ({conflict_constraint}) DO UPDATE SET {update_keys}"
183-
184-    @staticmethod
185-    def delete_keys(table, keys, conditions='item_type=?'):
186:        update_keys = ', '.join([f'{k}=NULL' for k in keys])
187-        conditions_str = f'WHERE {conditions}' if conditions else ''
188-        return f'UPDATE {table} SET {update_keys} {conditions_str}'
189-
190-    @staticmethod
191-    def delete_item(table, conditions='id=?'):
192-        return f'DELETE FROM {table} WHERE {conditions}'
193-
194-    @staticmethod
195-    def update_if_null(table, keys, conditions='id=?'):
196:        update_keys = ', '.join([f'{k}=ifnull(?,{k})' for k in keys])
197-        return f'UPDATE {table} SET {update_keys} WHERE {conditions}'
198-
199-    @staticmethod
200-    def select_limit(table, keys, conditions='id=?'):
201-        return f"SELECT {', '.join(keys)} FROM {table} WHERE {conditions} LIMIT 1"
--
239-
240-    def set_many_values(self, table=DEFAULT_TABLE, keys=(), data=None, connection=None):
241-        if not data: return
242-        def _transaction(conn):
243-            self.create_many_items(table=table, item_ids=list(data.keys()), connection=conn)
244:            self.execute_sql(DatabaseStatements.update_if_null(table, keys), data=[(*values, item_id) for item_id, values in data.items()], connection=conn)
245-
246-        if connection: _transaction(connection)
247-        else:
- üîç High SELECT count (6) - check for batch opportunities
- ‚úÖ Already uses prepared statements or batch operations
- üîó Contains connection management code
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
173:        return f"INSERT OR IGNORE INTO {table}({', '.join(keys)}) VALUES ({', '.join(['?' for _ in keys])})"
177:        return f"INSERT OR REPLACE INTO {table}({', '.join(keys)}) VALUES ({', '.join(['?' for _ in keys])})"
182:        return f"INSERT INTO {table}({', '.join(keys)}) VALUES ({', '.join(['?' for _ in keys])}) ON CONFLICT ({conflict_constraint}) DO UPDATE SET {update_keys}"
188:        return f'UPDATE {table} SET {update_keys} {conditions_str}'
192:        return f'DELETE FROM {table} WHERE {conditions}'
197:        return f'UPDATE {table} SET {update_keys} WHERE {conditions}'
201:        return f"SELECT {', '.join(keys)} FROM {table} WHERE {conditions} LIMIT 1"
206:        return f"SELECT {', '.join(keys)} FROM {table}{conditions_str}"
```

**Potential Issues:**
- üö® Potential N+1 query pattern detected
- ‚è±Ô∏è  Synchronous database operations in loops

---

### File: resources/tmdbhelper/lib/files/dbfunc.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 2
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üîó Contains connection management code
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/files/downloader.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 7
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/files/futils.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 6
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/files/hcache.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/files/locker.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/files/mcache.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/files/scache.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/container.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 7
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/context.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/basedata.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseitem_factories/concrete_classes/baseclass.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 3
- execute() calls: 2
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
78-        return data
79-
80-    @property
81-    def cached_data_keys(self):
82-        """ SELECT """
83:        return tuple([f'{self.table}.{k}' for k in self.keys])
84-
85-    @property
86-    def cached_data_table(self):
87-        """ FROM """
88-        return f'baseitem LEFT JOIN {self.table} ON {self.table}.id = baseitem.id'
--
185-        kwgs = {'delete_cascade': bool(self.cache_refresh == 'force')}
186-
187-        queue = []
--
191-            with contextlib.suppress(AttributeError):
192-                qitem = db_cache.try_cached_data(online_data_mapped)
193-                queue.append(qitem)
194-
195-        if return_queue:
--
203-        return self.get_cached_data()
204-
205-    def write_data_queue(self, queue):
206-        with self.connection.open():
207-            self.connection.open_connection.execute('BEGIN')
208:            for func, args, kwgs in queue:
209-                func(*args, **kwgs)
210-            self.connection.open_connection.execute('COMMIT')
211-
212-    @cached_property
213-    def data(self):
- üîó Contains connection management code
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- üö® Potential N+1 query pattern detected
- ‚ö†Ô∏è  Database operations without visible error handling
- ‚è±Ô∏è  Synchronous database operations in loops

---

### File: resources/tmdbhelper/lib/items/database/baseitem_factories/concrete_classes/basemedia.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseitem_factories/concrete_classes/episode.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
87-            ' LEFT JOIN episode last_aired ON last_aired.id = tvshow.last_episode_to_air_id'
88-        )
89-
90-    def get_cached_data_keys(self):
91-        """ SELECT """
92:        cached_data_keys = [f'{self.table}.{k}' for k in self.keys if k != 'status']
93-        cached_data_keys.extend([
94-            'episode.status AS episode_type',
95-            'tvshow.title AS tvshowtitle',
96-            'tvshow.originaltitle AS tvshow_originaltitle',
97-            'tvshow.tagline AS tagline',
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseitem_factories/concrete_classes/movie.py

**Query Counts:**
- SELECT statements: 3
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
35-        )
36-
37-    @property
38-    def cached_data_keys(self):
39-        """ SELECT """
40:        cached_data_keys = [f'{self.table}.{k}' for k in self.keys]
41-        cached_data_keys.extend([
42-            'collection.title AS collection_title',
43-            'collection.tmdb_id AS collection_tmdb_id',
44-            'collection.id AS collection_id',
45-            (
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
46:                '(  SELECT art.icon FROM art'
57:                '(  SELECT art.icon FROM art'
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/items/database/baseitem_factories/concrete_classes/person.py

**Query Counts:**
- SELECT statements: 8
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
7-    ftv_id = None
8-
9-    @property
10-    def cached_data_keys(self):
11-        """ SELECT """
12:        cached_data_keys = [f'{self.table}.{k}' for k in self.keys]
13-        cached_data_keys.extend([
14-            (
15-                '(    SELECT COUNT(DISTINCT castmember.parent_id) '
16-                '     FROM castmember WHERE castmember.tmdb_id=person.tmdb_id '
17-                ') as total_cast'
- üîç High SELECT count (8) - check for batch opportunities
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
49:                '(    SELECT art.icon FROM art'
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling
- ‚è±Ô∏è  Synchronous database operations in loops

---

### File: resources/tmdbhelper/lib/items/database/baseitem_factories/concrete_classes/season.py

**Query Counts:**
- SELECT statements: 3
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
89-            ' LEFT JOIN episode last_aired ON last_aired.id = tvshow.last_episode_to_air_id'
90-        )
91-
92-    def get_cached_data_keys(self):
93-        """ SELECT """
94:        cached_data_keys = [f'{self.table}.{k}' for k in self.keys if k not in ('plot', 'status', 'duration')]
95-        cached_data_keys.extend([
96-            'tvshow.title AS tvshowtitle',
97-            'tvshow.tagline as tagline',
98-            'tvshow.status AS status',
99-            'ifnull(season.plot, tvshow.plot) as plot',
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseitem_factories/concrete_classes/series.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
9-    # online_data_kwgs = {}
10-
11-    @property
12-    def cached_data_keys(self):
13-        """ SELECT """
14:        cached_data_keys = [f'{self.table}.{k}' for k in self.keys]
15-        return tuple(cached_data_keys)
16-
17-    @staticmethod
18-    def set_unaired_expiry(*args, **kwargs):
19-        return  # Collections dont have premiered dates so we dont modify expiry time
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/items/database/baseitem_factories/concrete_classes/tvshow.py

**Query Counts:**
- SELECT statements: 2
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
32-        ]
33-
34-    @property
35-    def cached_data_keys(self):
36-        """ SELECT """
37:        cached_data_keys = [f'{self.table}.{k}' for k in self.keys if k != 'duration']
38-        cached_data_keys.extend([(
39-            'ifnull('
40-            '(    SELECT CAST(AVG(episode.duration) as INTEGER) '
41-            '     FROM episode WHERE episode.tvshow_id=tvshow.id '
42-            '                    AND episode.premiered<=DATE("now")'
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling
- ‚è±Ô∏è  Synchronous database operations in loops

---

### File: resources/tmdbhelper/lib/items/database/baseitem_factories/factory.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/basemeta_factories/concrete_classes/appearances.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/basemeta_factories/concrete_classes/art.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/basemeta_factories/concrete_classes/baseclass.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/basemeta_factories/concrete_classes/credits.py

**Query Counts:**
- SELECT statements: 2
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
13:            '(    SELECT art.icon FROM art'
37:            '(    SELECT art.icon FROM art'
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/items/database/basemeta_factories/concrete_classes/fanart_tv.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/basemeta_factories/concrete_classes/info.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/basemeta_factories/concrete_classes/series.py

**Query Counts:**
- SELECT statements: 2
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/items/database/basemeta_factories/concrete_classes/trakt.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/basemeta_factories/concrete_classes/user_art.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/basemeta_factories/factory.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/anticipatedepisodes.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/anticipatedseason.py

**Query Counts:**
- SELECT statements: 2
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
17:            for season in self.parent_season_media_list
18-            if season and 'infolabels' in season and season['infolabels'].get('season')
19-        ]
20-        return self.get_parent_data('season', max(season_numbers), cache_refresh='basic')
21-
22-    @property
--
67-        return map_item_art
68-
69-    def get_cached_data_keys(self):
70-        """ SELECT """
71-
72:        cached_data_keys = [f'{self.table}.{k}' for k in self.keys if k != 'plot']
73-        cached_data_keys.extend([
74-            'tvshow.title AS tvshowtitle',
75-            'tvshow.tagline as tagline',
76-            'ifnull(season.plot, tvshow.plot) as plot',
77-            (
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/baseclass.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
22-        return self.get_base_id(self.tmdb_type, self.tmdb_id)
23-
24-    @property
25-    def cached_data_keys(self):
26-        """ SELECT """
27:        return tuple((f'{self.table}.{k}' for k in self.keys))
28-
29-    @property
30-    def cached_data_values(self):
31-        """ WHERE condition ? ? ? ? = value, value, value, value """
32-        return (self.item_id, self.current_time, DATALEVEL_MAX)
--
38-    def parent_item_data(self):
39-        return self.get_parent_data(self.mediatype, self.season, self.episode)
40-
- üîó Contains connection management code
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/basemedia.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/castmember.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
51:                '(    SELECT art.icon FROM art'
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/clearlogo.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/creditscombined.py

**Query Counts:**
- SELECT statements: 4
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/crewedcombined.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/crewedmovies.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/crewedtvshows.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/crewmember.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/episodes.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/fanart.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/flatseasons.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/ftv_clearlogo.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/ftv_fanart.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/ftv_landscape.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/ftv_poster.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/image.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/poster.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/ratings.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 2
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
- üîó Contains connection management code
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/seasons.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/seriesmovies.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/starredcombined.py

**Query Counts:**
- SELECT statements: 2
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/starredmovies.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/starredtvshows.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/thumb.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/upnextseason.py

**Query Counts:**
- SELECT statements: 2
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
16-        map_item_art['poster'] = map_item_art['thumb']
17-        return map_item_art
18-
19-    def get_cached_data_keys(self):
20-        """ SELECT """
21:        cached_data_keys = [f'{self.table}.{k}' for k in self.keys if k != 'plot']
22-        cached_data_keys.extend([
23-            'tvshow.title AS tvshowtitle',
24-            'tvshow.tagline as tagline',
25-            'ifnull(season.plot, tvshow.plot) as plot',
26-            (
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/videos.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/baseview_factories/factory.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/database.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/itemmeta_factories/concrete_classes/baseclass.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 3
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/itemmeta_factories/concrete_classes/basemedia.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 4
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/itemmeta_factories/concrete_classes/baseroutes.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/itemmeta_factories/concrete_classes/episode.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/itemmeta_factories/concrete_classes/movie.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/itemmeta_factories/concrete_classes/person.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/itemmeta_factories/concrete_classes/season.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/itemmeta_factories/concrete_classes/series.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/itemmeta_factories/concrete_classes/tvshow.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/itemmeta_factories/factory.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/listitem.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 2
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
233-        with TimerList(self.timer_lists, ' - online', log_threshold=0.001, logging=self.log_timers):
--
238-            return listitem_config.try_queued_data()
239-
240-        with ParallelThread(self.uncached_items, _queued_data) as pt:
241-            item_queue = pt.queue
242-
243:        return list(itertools.chain.from_iterable((i for i in item_queue if i)))
244-
245-    def set_func_queue(self):
246-        self.connection.open_connection.execute('BEGIN')
247-        with TimerList(self.timer_lists, ' - writer', log_threshold=0.001, logging=self.log_timers):
248:            for func, args, kwgs in self.func_queue:
249-                func(*args, **kwgs)
250-        with TimerList(self.timer_lists, ' - commit', log_threshold=0.001, logging=self.log_timers):
251-            self.connection.open_connection.execute('COMMIT')
252-        with TimerList(self.timer_lists, ' - return', log_threshold=0.001, logging=self.log_timers):
253-            self.cached_data = self.get_cached_data()
--
284-    def get_item(self, tmdb_type, tmdb_id, season=None, episode=None):
285-        return ListItemCacher(self, tmdb_type, tmdb_id, season, episode).get_item(
286-            connection=self.connection, cache_refresh=self.cache_refresh)
287-
288-    def configure_listitems_threaded(self, items):
289:        return ListItemThread(self, [ListItemConfig(self, i) for i in items]).configured_items
- üîó Contains connection management code
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- üö® Potential N+1 query pattern detected
- ‚è±Ô∏è  Synchronous database operations in loops

---

### File: resources/tmdbhelper/lib/items/database/mappings.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 2
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/database/tabledef.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 2
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/basedir_calendar.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/basedir_details.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/basedir_item.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/basedir_main.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/basedir_mdblist.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/basedir_nodes.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/basedir_random.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/basedir_tmdb.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/basedir_tmdb_v4.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/basedir_trakt_genre.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/basedir_trakt.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/basedir_tvdb.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/item_builder.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 6
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/item_details_builder.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 4
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/lists_base.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/base/lists_details.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/lists_default.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/mdblist/lists_custom.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/mdblist/lists_lists.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/mdblist/lists_local.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/mdblist/lists_sorting.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/mdblist/mapper_lists.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/mdblist/mapper_standard.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tmdb/lists_allitems.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 7
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tmdb/lists_authenticated.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tmdb/lists_discover.py

**Query Counts:**
- SELECT statements: 28
- INSERT statements: 0
0
- UPDATE statements: 2
- DELETE statements: 3
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üîç High SELECT count (28) - check for batch opportunities
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tmdb/lists_nextup.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tmdb/lists_random.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 5
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tmdb/lists_related.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tmdb/lists_search.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 5
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tmdb/lists_seasons.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tmdb/lists_standard.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tmdb/lists_view_db.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/lists_airingnext.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 2
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/lists_calendar.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/lists_custom.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/lists_filtered.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/lists_random.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/lists_related.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/lists_sorting.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/lists_standard.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/lists_static.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/lists_sync.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/lists_years.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/mapper_basic.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/mapper_calendar.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/mapper_comments.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/mapper_standard.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 4
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/mapper_static.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 2
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/trakt/mapper_watchers.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tvdb/lists_awards.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tvdb/lists_genres.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/directories/tvdb/lists_tvdb.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/filters.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/itemlist.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/kodi.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/listitem.py

**Query Counts:**
- SELECT statements: 2
- INSERT statements: 1
- UPDATE statements: 8
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/pages.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/router.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/routes.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/items/trakt.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/baseitem.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/common.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 3
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/cronjob.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 21
- DELETE statements: 3
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/images.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 1
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/imgmon.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 5
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/itemdetails.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 7
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/listitemtools.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 6
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/player.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 10
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/poller.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 5
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/scrobbler.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 6
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/service.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 19
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/update.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/monitor/utils.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/actions/action.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/actions/dialog.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/actions/keyboard.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/actions/meta.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/actions/resolver.py

**Query Counts:**
- SELECT statements: 7
- INSERT statements: 0
0
- UPDATE statements: 2
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üîç High SELECT count (7) - check for batch opportunities
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/actions/validation.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/configure.py

**Query Counts:**
- SELECT statements: 8
- INSERT statements: 0
0
- UPDATE statements: 2
- DELETE statements: 4
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üîç High SELECT count (8) - check for batch opportunities
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/create.py

**Query Counts:**
- SELECT statements: 5
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/details/details.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/details/playerstring.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/editsteps.py

**Query Counts:**
- SELECT statements: 6
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 2
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üîç High SELECT count (6) - check for batch opportunities

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/files.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 1
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/inputter.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/method/play.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/phacks/phacks.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/phacks/resolved_url.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 6
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/phacks/update_listing.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 4
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/player_id.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/players.py

**Query Counts:**
- SELECT statements: 20
- INSERT statements: 0
0
- UPDATE statements: 12
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üîç High SELECT count (20) - check for batch opportunities
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/putils.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/player/select.py

**Query Counts:**
- SELECT statements: 10
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üîç High SELECT count (10) - check for batch opportunities
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/certification.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 1
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 1
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
36-            i['meaning'],
37-            i['order']
38-        )
39-
40-    def set_tables(self, connection, statements, data):
41:        for iso_country, v in data.items():
42:            for i in v:
43:                for x, statement in enumerate(statements):
44-                    connection.execute(statement, self.insert_statements[x].mapping(i, iso_country))
45-
46-
47-class FindQueriesDatabaseCertification:
48-    certification_columns = {
- üîó Contains connection management code

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- üö® Potential N+1 query pattern detected
- ‚è±Ô∏è  Synchronous database operations in loops

---

### File: resources/tmdbhelper/lib/query/database/collections.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/daily_export.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 8
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/database.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üîó Contains connection management code
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/genres.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/identifier.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 2
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üîó Contains connection management code
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- ‚ö†Ô∏è  Database operations without visible error handling

---

### File: resources/tmdbhelper/lib/query/database/imdb_top250.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/keywords.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/movies.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/networks.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/provider_regions.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/studios.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/table.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 4
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 3
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
61-
62-    @staticmethod
63-    def get_mapping(data):
64-        if not data:
65-            return
66:        return [{k: i[k] for k in i.keys()} for i in data]
67-
68-    def set_tables(self, connection, statements, data):
69:        for i in data:
70:            for x, statement in enumerate(statements):
71-                connection.execute(statement, self.insert_statements[x].mapping(i))
72-
73-    def get(self):
74-        data = None
75-        with self.access.connection.open():
--
91-        try:
92-            data = data[self.response_key] or {}
93-        except (KeyError, AttributeError, TypeError):
94-            return
95-
96:        statements = [i.statement(i.table, i.keys) for i in self.insert_statements]
97-
98-        with self.access.connection.open() as connection:
99-            connection.execute('BEGIN')
100-            self.set_tables(connection, statements, data)
101-            self.set_expiry(self.expiry_id)
- üîó Contains connection management code

**SQL Queries Found:**
```sql
```

**Potential Issues:**
- üö® Potential N+1 query pattern detected
- ‚è±Ô∏è  Synchronous database operations in loops

---

### File: resources/tmdbhelper/lib/query/database/tmdb_id.py

**Query Counts:**
- SELECT statements: 2
- INSERT statements: 2
- UPDATE statements: 10
- DELETE statements: 0
0
- execute() calls: 4
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
- üîó Contains connection management code
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/trakt_id.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/trakt_stats.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/tvshows.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/user_ratings.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/query/database/watch_providers.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 3
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/build_awards.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 9
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/context_menu.py

**Query Counts:**
- SELECT statements: 2
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/decorators.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/image_functions.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/kodi_utils.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/library.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 6
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/logging.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/maintenance.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 13
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/make_node.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/modify_artwork.py

**Query Counts:**
- SELECT statements: 10
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 5
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üîç High SELECT count (10) - check for batch opportunities
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/modify_identifier.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/players.py

**Query Counts:**
- SELECT statements: 3
- INSERT statements: 0
0
- UPDATE statements: 4
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/settings.py

**Query Counts:**
- SELECT statements: 5
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/test.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/method/tmdb.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 3
- DELETE statements: 3
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
70-            return
71-        mediatype = choices[x]
72-
--
90-        total=(len(routes[mediatype]['baseitems']) + len(routes[mediatype]['tables']) + 1),
91-        background=False,
92-    ) as progress_dialog:
93-        database = ItemDetailsDatabase()
94-        with TimerFunc(f'Deleting mediatype {mediatype}:', inline=True):
95:            for i in routes[mediatype]['baseitems']:
96-                statement = f'DELETE FROM baseitem WHERE mediatype="{i}"'
97-                progress_dialog.update(statement)
98-                database.execute_sql(statement)
99:            for i in routes[mediatype]['tables']:
100-                statement = f'DELETE FROM {i}'
101-                progress_dialog.update(statement)
102-                database.execute_sql(statement)
103-            progress_dialog.update('Vacuuming database...')
104-            database.execute_sql('VACUUM')
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
96:                statement = f'DELETE FROM baseitem WHERE mediatype="{i}"'
100:                statement = f'DELETE FROM {i}'
```

**Potential Issues:**
- üö® Potential N+1 query pattern detected

---

### File: resources/tmdbhelper/lib/script/method/trakt.py

**Query Counts:**
- SELECT statements: 4
- INSERT statements: 0
0
- UPDATE statements: 6
- DELETE statements: 8
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/router.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 6
- DELETE statements: 4
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/item.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/menu.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/tmdb/basic.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/tmdb/item.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/tmdb/menu.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/tmdb/rating.py

**Query Counts:**
- SELECT statements: 9
- INSERT statements: 0
0
- UPDATE statements: 8
- DELETE statements: 1
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üîç High SELECT count (9) - check for batch opportunities
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/tmdb/userlist.py

**Query Counts:**
- SELECT statements: 2
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 1
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/trakt/basic.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/trakt/comments.py

**Query Counts:**
- SELECT statements: 4
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/trakt/item.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/trakt/menu.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/trakt/progress.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 1
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/trakt/rating.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/script/sync/trakt/userlist.py

**Query Counts:**
- SELECT statements: 1
- INSERT statements: 0
0
- UPDATE statements: 2
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/update/cacher.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 4
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/update/common.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 6
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/update/library.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 14
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/update/logger.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 7
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/update/tagger.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 7
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/update/update.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/update/userlist.py

**Query Counts:**
- SELECT statements: 2
- INSERT statements: 0
0
- UPDATE statements: 6
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/window/constants.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/window/direct_call_auto.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/window/event_loop.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 0
0
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/window/manager.py

**Query Counts:**
- SELECT statements: 0
0
- INSERT statements: 0
0
- UPDATE statements: 3
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

### File: resources/tmdbhelper/lib/window/recommendations.py

**Query Counts:**
- SELECT statements: 2
- INSERT statements: 0
0
- UPDATE statements: 4
- DELETE statements: 0
0
- execute() calls: 0
0
- fetchone() calls: 0
0
- fetchall() calls: 0
0

**Potential Batch Optimization Opportunities:**
- ‚ö†Ô∏è  Contains loops with potential database operations
- üíæ Contains caching logic

**SQL Queries Found:**
```sql
```

**Potential Issues:**

---

## Database Schema Analysis

### Table Definitions Found:

**resources/tmdbhelper/lib/files/dbdata.py:**
```sql
            query = f'CREATE TABLE IF NOT EXISTS {table}({", ".join(query_parts)})'
            try: cursor.execute(query)
            except Exception as error: self.kodi_log(f'CACHE: Exception while initializing _database: {error}\n{self._sc_name} - {query}', 1)

        for table, columns in self.database_tables.items():
            for column, v in columns.items():
                if not v.get('indexed'): continue
                query = f'CREATE INDEX IF NOT EXISTS {table}_{column}_x ON {table}({column})'
                try: cursor.execute(query)
                except Exception as error: self.kodi_log(f'CACHE: Exception while initializing _database: {error}\n{self._sc_name} - {query}', 1)

        if this_database_version < self.database_version:
            try:
                query = f"PRAGMA user_version = {self.database_version}"
                cursor.execute(query)
            except Exception as error: self.kodi_log(f'CACHE: Exception while initializing _database: {error}\n{self._sc_name} - {query}', 1)

        return connection


class DatabaseStatements:
```

### Most Referenced Tables:

Table reference frequency:
```
   1011 tmdbhelper
    216 jurialmunkey
     61 xbmcgui
     17 xbmc
     11 json
     10 episode
      9 collections
      8 urllib
      8 tvshow
      8 the
      7 movie
      7 art
      7 a
      6 xbmcplugin
      6 threading
      5 xbmcaddon
      5 person
      5 import
      5 belongs
      4 parent
```

## Database Connection Analysis

### Connection usage in resources/tmdbhelper/lib/items/database/baseitem_factories/concrete_classes/baseclass.py:
```python
108-        database_obj.mediatype = self.mediatype
109-        database_obj.tmdb_id = self.tmdb_id
110-        database_obj.item_id = self.item_id
111-        database_obj.parent_id = self.parent_id
112-        database_obj.common_apis = self.common_apis
113:        database_obj.connection = self.connection
114-        return database_obj
115-
116-    def return_basemeta_db(self, route, subtype=None):
117-        attr = f'basemeta_db_{route}' if not subtype else f'basemeta_db_{route}_{subtype}'
118-
--
150-            return
151-
152-        self.expiry_time = ((days_to_air // 2) + 1) * DAY_IN_SECONDS  # Refresh in half number of days (rounded + 1)
153-
154-    def get_cached_data(self):
155:        with self.connection.open():
156-            data = self.get_cached_list_values(self.cached_data_table, self.cached_data_keys, self.cached_data_values, self.cached_data_conditions)
157-            if not data or not data[0] or not data[0][self.cached_data_check_key]:
158-                return
159-            return self.get_item_meta(data)
160-
--
201-            return
202-
203-        return self.get_cached_data()
204-
205-    def write_data_queue(self, queue):
206:        with self.connection.open():
207:            self.connection.open_connection.execute('BEGIN')
208-            for func, args, kwgs in queue:
209-                func(*args, **kwgs)
210:            self.connection.open_connection.execute('COMMIT')
211-
212-    @cached_property
213-    def data(self):
214-        """ cached_property wrapper to set get_data to attribute for reuse """
215-        return self.get_data()
```

### Connection usage in resources/tmdbhelper/lib/items/database/listitem.py:
```python
109-    def db_cache(self):
110-        if not self.baseitem_db_cache_func:
111-            return
112-        return self.baseitem_db_cache_func(self.mediatype, self.tmdb_id, self.season, self.episode)
113-
114:    def get_cached_item(self, connection):
115-        if not self.listitem_cacher:
116-            return
117:        return self.listitem_cacher.get_cached_item(connection)
118-
119-    def try_queued_data(self):
120-        if not self.listitem_cacher:
121-            return
122-        return self.listitem_cacher.try_queued_data()
--
163-            data['label'] = data['infolabels']['title']
164-        except(AttributeError, TypeError, KeyError):
165-            pass
166-        return data
167-
168:    def get_item(self, connection, cache_refresh=None):
169-        if not self.baseitem_db_cache:
170-            return
171:        self.baseitem_db_cache.connection = connection
172-        self.baseitem_db_cache.cache_refresh = cache_refresh
173-        return self.add_item_details(self.baseitem_db_cache.data)
174-
175:    def get_cached_item(self, connection):
176-        if not self.baseitem_db_cache:
177-            return
178:        self.baseitem_db_cache.connection = connection
179-        self.baseitem_db_cache.cache_refresh = self.parent.cache_refresh
180-        return self.add_item_details(self.baseitem_db_cache.get_cached_data())
181-
182-    def try_queued_data(self):
183-        if not self.baseitem_db_cache:
--
190-    def __init__(self, parent, items):
191-        if parent.__class__.__name__ != 'ListItemDetails':
192-            raise Exception(f'Requires ListItemDetails parent but {parent.__class__.__name__} given')
193-        self.parent = parent
194-        self.items = items
195:        self.connection = self.parent.connection
196-        self.log_timers = self.parent.log_timers
197-        self.timer_lists = self.parent.timer_lists
198-
199-    @cached_property
200-    def cached_data(self):
201-        with TimerList(self.timer_lists, ' - cached', log_threshold=0.001, logging=self.log_timers):
202:            with self.connection.open():
203-                return self.get_cached_data()
204-
205-    def get_cached_data(self):
206-        return [
207:            listitem_config.get_cached_item(self.connection)
208-            for listitem_config in self.items
209-        ]
210-
211-    @cached_property
212-    def uncached_items(self):
--
241-            item_queue = pt.queue
242-
243-        return list(itertools.chain.from_iterable((i for i in item_queue if i)))
244-
245-    def set_func_queue(self):
246:        self.connection.open_connection.execute('BEGIN')
247-        with TimerList(self.timer_lists, ' - writer', log_threshold=0.001, logging=self.log_timers):
248-            for func, args, kwgs in self.func_queue:
249-                func(*args, **kwgs)
250-        with TimerList(self.timer_lists, ' - commit', log_threshold=0.001, logging=self.log_timers):
251:            self.connection.open_connection.execute('COMMIT')
252-        with TimerList(self.timer_lists, ' - return', log_threshold=0.001, logging=self.log_timers):
253-            self.cached_data = self.get_cached_data()
254-
255-    @cached_property
256-    def configured_items(self):
--
258-            return self.configured_list
259-        if not self.uncached_items:
260-            return self.configured_list
261-        if not self.func_queue:
262-            return self.configured_list
263:        with self.connection.open():
264-            self.set_func_queue()
265-        return self.configured_list
266-
267-
268-class ListItemDetails:
--
276-    def __init__(self, common_apis=None):
277-        self.common_apis = common_apis or CommonContainerAPIs()
278-        self.cache = ItemDetailsDatabase()
279-
280-    @cached_property
281:    def connection(self):
282-        return DatabaseConnection(self.cache)
283-
284-    def get_item(self, tmdb_type, tmdb_id, season=None, episode=None):
285-        return ListItemCacher(self, tmdb_type, tmdb_id, season, episode).get_item(
286:            connection=self.connection, cache_refresh=self.cache_refresh)
287-
288-    def configure_listitems_threaded(self, items):
289-        return ListItemThread(self, [ListItemConfig(self, i) for i in items]).configured_items
```

### Connection usage in resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/ratings.py:
```python
188-
189-        func = self.set_cached_values
190-        args = (self.table, self.item_id, self.keys)
191-        kwgs = {'values': self.configure_mapped_data(self.online_data_mapped)}
192-
193:        with self.connection.open():
194:            self.connection.open_connection.execute('BEGIN')
195-            func(*args, **kwgs)
196:            self.connection.open_connection.execute('COMMIT')
197-
198-        if not return_data:
199-            return
200-        return self.get_cached_data()
```

### Connection usage in resources/tmdbhelper/lib/items/database/baseview_factories/concrete_classes/baseclass.py:
```python
49-                base_dbc.tmdb_type = self.tmdb_type
50-                base_dbc.season = season
51-                base_dbc.episode = episode
52-                base_dbc.cache_refresh = cache_refresh
53-                base_dbc.common_apis = self.common_apis
54:                base_dbc.connection = self.connection
55-                base_dbc.cache = self.cache
56-            except (TypeError, KeyError, IndexError, ValueError):
57-                return
58-            return base_dbc.data
59-
60-    def get_unmapped_data(self):
61:        with self.connection.open():
62-            data = self.get_cached_list_values(
63-                self.cached_data_table,
64-                self.cached_data_keys,
65-                self.cached_data_values,
66-                self.cached_data_conditions
```

### Connection usage in resources/tmdbhelper/lib/api/request.py:
```python
13-def null_function(*args, **kwargs):
14-    return
15-
16-
17-class ConnectionPool:
18:    """HTTP connection pool for reusing connections"""
19-    _instance = None
20-    _lock = threading.Lock()
21-    
22-    def __new__(cls):
23-        if cls._instance is None:
--
29-    
30-    def __init__(self):
31-        if hasattr(self, '_initialized') and self._initialized:
32-            return
33-        
34:        self.max_connections = int(get_setting('max_connections_per_host', '8'))
35-        self.pools = defaultdict(list)
36-        self.pool_lock = threading.Lock()
37:        self.active_connections = defaultdict(int)
38-        self._initialized = True
39-    
40-    def get_session(self, host):
41-        """Get or create a session for the given host"""
42-        with self.pool_lock:
--
45-                # Verify session is still valid
46-                if hasattr(session, '_closed') and not session._closed:
47-                    return session
48-            
49-            # Create new session if under limit
50:            if self.active_connections[host] < self.max_connections:
51-                try:
52-                    import requests
53-                    session = requests.Session()
54-                    
55-                    # Configure session for optimal performance
56-                    adapter = requests.adapters.HTTPAdapter(
57:                        pool_connections=self.max_connections,
58:                        pool_maxsize=self.max_connections,
59-                        max_retries=1
60-                    )
61-                    session.mount('http://', adapter)
62-                    session.mount('https://', adapter)
63-                    
64-                    session.headers.update({
65-                        'Accept-Encoding': 'gzip, deflate',
66-                        'Connection': 'keep-alive',
67-                    })
68-                    
69:                    self.active_connections[host] += 1
70-                    return session
71-                except Exception as e:
72-                    kodi_log(f"Failed to create session for {host}: {e}", level=2)
73-            
74-            return None
75-    
76-    def return_session(self, host, session):
77-        """Return session to pool for reuse"""
78-        try:
79-            with self.pool_lock:
80:                if (len(self.pools[host]) < self.max_connections and 
81-                    hasattr(session, '_closed') and not session._closed):
82-                    self.pools[host].append(session)
83-                else:
84-                    session.close()
85-        except Exception as e:
--
242-    """Decorator to add performance enhancements to request methods"""
243-    @wraps(func)
244-    def wrapper(self, *args, **kwargs):
245-        # Initialize performance components if needed
246-        if not hasattr(self, '_perf_initialized'):
247:            self._connection_pool = ConnectionPool()
248-            self._memory_cache = RequestMemoryCache()
249-            self._rate_limiter = RateLimiter()
250-            self._perf_initialized = True
251-        
252-        return func(self, *args, **kwargs)
253-    return wrapper
254-
255-
256-class RequestAPI(jurialmunkey.reqapi.RequestAPI):
257:    error_notification = get_setting('connection_notifications')
258-    _basiccache = BasicCache
259-
260-    @staticmethod
261-    def kodi_log(msg, level=0):
262-        kodi_log(msg, level)
263-    
264-    @enhance_performance
265-    def request(self, *args, **kwargs):
266:        """Enhanced request method with connection pooling and memory caching"""
267-        url = args[0] if args else kwargs.get('url')
268-        method = kwargs.get('method', 'GET').upper()
269-        
270-        if not url:
271-            return super().request(*args, **kwargs)
--
295-        if get_setting('enable_rate_limiting', True):
296-            wait_time = self._rate_limiter.wait_if_needed(host)
297-            if wait_time > 0:
298-                time.sleep(wait_time)
299-        
300:        # Try to use connection pool for better performance
301:        if get_setting('use_connection_pool', True):
302:            session = self._connection_pool.get_session(host)
303-            if session:
304-                try:
305:                    # Make request using pooled connection
306-                    response = self._make_pooled_request(session, url, method, **kwargs)
307-                    
308-                    # Return session to pool
309:                    self._connection_pool.return_session(host, session)
310-                    
311-                    # Record request for rate limiting
312-                    if get_setting('enable_rate_limiting', True):
313-                        self._rate_limiter.record_request(host)
314-                    
--
328-                    return response
329-                    
330-                except Exception as e:
331-                    kodi_log(f"Pooled request failed for {url}: {e}", level=1)
332-                    # Return session to pool even on error
333:                    self._connection_pool.return_session(host, session)
334-        
335-        # Fallback to parent implementation
336-        response = super().request(*args, **kwargs)
337-        
338-        # Record request for rate limiting even on fallback
--
362-class NoCacheRequestAPI(RequestAPI):
363-    _basiccache = null_function
364-    
365-    @enhance_performance
366-    def request(self, *args, **kwargs):
367:        """Enhanced no-cache request with connection pooling but no caching"""
368-        # Temporarily disable memory caching for this request
369-        original_setting = get_setting('use_memory_cache', True)
370-        
371-        # Override memory cache setting temporarily
372-        import tmdbhelper.lib.addon.plugin as plugin_module
```

### Connection usage in resources/tmdbhelper/lib/query/database/tmdb_id.py:
```python
33-            return data[0]['tmdb_id']  # return data[0] for multi
34-        except (AttributeError, KeyError, TypeError, IndexError):
35-            return
36-
37-    def get_id(self):
38:        with self.access.connection.open():
39-            return self.get_id_results(self.access.get_cached_list_values(
40-                self.table,
41-                keys=self.keys,
42-                values=self.values,
43-                conditions=self.conditions))
--
48-
49-        statement_insert = DatabaseStatements.insert_or_ignore(self.table, ('tmdb_id', 'tmdb_type'))
50-        statement_update = DatabaseStatements.update_if_null(
51-            self.table, self.update_keys, conditions="tmdb_type=? AND tmdb_id=?")
52-
53:        with self.access.connection.open() as connection:
54:            connection.execute('BEGIN')
55:            connection.execute(statement_insert, (self.tmdb_id, self.tmdb_type))
56:            connection.execute(statement_update, self.update_values)
57:            connection.execute('COMMIT')
58-
59-        return self.get_id()
60-
61-
62-class TableFindID(TableID):
```

### Connection usage in resources/tmdbhelper/lib/query/database/identifier.py:
```python
62-        identifier_tuple = IdentifierTuple(item_id, tmdb_id, tmdb_type)
63-        self.set_cached_values(TABLE, KEYS, [identifier_tuple])
64-        return identifier_tuple
65-
66-    def del_identifier(self, item_id):
67:        with self.access.connection.open() as connection:
68:            connection.execute('BEGIN')
69-            self.access.del_cached(TABLE, item_id, children=False)
70:            connection.execute('COMMIT')
```

### Connection usage in resources/tmdbhelper/lib/query/database/table.py:
```python
63-    def get_mapping(data):
64-        if not data:
65-            return
66-        return [{k: i[k] for k in i.keys()} for i in data]
67-
68:    def set_tables(self, connection, statements, data):
69-        for i in data:
70-            for x, statement in enumerate(statements):
71:                connection.execute(statement, self.insert_statements[x].mapping(i))
72-
73-    def get(self):
74-        data = None
75:        with self.access.connection.open():
76-            if not self.is_expired_get:
77-                data = self.parent.get_list_values(
78-                    self.table,
79-                    keys=self.keys,
80-                    values=self.values,
81-                    conditions=self.conditions)
82-        return self.get_mapping(data)
83-
84-    def set(self):
85:        with self.access.connection.open():
86-            if not self.is_expired_set:
87-                return
88-
89-        data = self.tmdb_api.get_response_json(*self.request_args, **self.request_kwgs)
90-
--
93-        except (KeyError, AttributeError, TypeError):
94-            return
95-
96-        statements = [i.statement(i.table, i.keys) for i in self.insert_statements]
97-
98:        with self.access.connection.open() as connection:
99:            connection.execute('BEGIN')
100:            self.set_tables(connection, statements, data)
101-            self.set_expiry(self.expiry_id)
102:            connection.execute('COMMIT')
103-
104-        return self.get()
105-
106-    def use(self):
107-        return self.get() or self.set()
```

### Connection usage in resources/tmdbhelper/lib/query/database/database.py:
```python
125-    def get_all_values(self, table, keys, values=None, conditions=None):
126-        return self.access.get_cached_list_values(table, keys=keys, values=values or (), conditions=conditions)
127-
128-    def get_cached_values(self, table, keys, mapping_function=None, values=None, conditions=None):
129-        data = None
130:        with self.access.connection.open():
131-            if not self.is_expired(table):
132-                data = self.get_all_values(
133-                    table,
134-                    keys=keys,
135-                    values=values,
136-                    conditions=conditions)
137-        return mapping_function(data) if mapping_function else data
138-
139-    def set_cached_values(self, table, keys, values, item_id=None, expiry=DEFAULT_EXPIRY, overwrite=True):
140:        with self.access.connection.open():
141-            if expiry:
142-                self.set_expiry(f'{table}.{item_id}' if item_id else table, expiry=expiry)
143-            self.access.set_cached_list_values(table, keys=keys, values=values, overwrite=overwrite)
```

### Connection usage in resources/tmdbhelper/lib/query/database/certification.py:
```python
35-            self.tmdb_type,
36-            i['meaning'],
37-            i['order']
38-        )
39-
40:    def set_tables(self, connection, statements, data):
41-        for iso_country, v in data.items():
42-            for i in v:
43-                for x, statement in enumerate(statements):
44:                    connection.execute(statement, self.insert_statements[x].mapping(i, iso_country))
45-
46-
47-class FindQueriesDatabaseCertification:
48-    certification_columns = {
49-        'iso_country': {
```

### Connection usage in resources/tmdbhelper/lib/files/dbfunc.py:
```python
3-from jurialmunkey.ftools import cached_property
4-from contextlib import contextmanager
5-
6-
7-class DatabaseConnection:
8:    open_connection = None
9-
10-    def __init__(self, cache):
11-        self.cache = cache
12-
13-    def close(self):
14:        if not self.open_connection:
15-            return
16:        self.open_connection.close()
17:        self.open_connection = None
18-
19-    @contextmanager
20-    def open(self):
21:        existing_connection = bool(self.open_connection)
22-
23:        if not existing_connection:
24:            self.open_connection = self.cache.get_database().cursor()
25-
26:        yield self.open_connection
27-
28:        if not existing_connection:
29-            self.close()
30-
31-
32-class DatabaseAccess:
33-
34-    @cached_property
35:    def connection(self):
36-        return DatabaseConnection(self.cache)
37-
38-    @property
39:    def open_connection(self):
40:        return self.connection.open_connection
41-
42-    # ======================================
43-    # Single item with single key/value pair
44-    # ======================================
45-
46-    def del_cached(self, table, item_id, children=True):
47:        self.cache.del_item(table, item_id, connection=self.open_connection)
48-        if not children:
49-            return
50:        self.cache.del_item_like(table, f'{item_id}.%', connection=self.open_connection)
51-
52-    def get_cached(self, table, item_id, key):
53:        data = self.cache.get_values(table, item_id, keys=(key, ), connection=self.open_connection)
54-        return data[0] if data else None
55-
56-    def set_cached(self, table, item_id, key, value):
57-        """ Set key to value for id=item_id in table """
58:        self.cache.set_item_values(table, item_id, keys=(key, ), values=(value, ), connection=self.open_connection)
59-
60-    def use_cached(self, table, item_id, key, func, *args, **kwargs):
61-        """ Get key for id=item_id in table else set key to func(*args, **kwargs) """
62-        internal_data = self.get_cached(table, item_id, key)
63-
--
73-    # =========================================
74-    # Single item with multiple key/value pairs
75-    # =========================================
76-
77-    def get_cached_values(self, table, item_id, keys):
78:        return self.cache.get_values(table, item_id, keys, connection=self.open_connection)
79-
80-    def set_cached_values(self, table, item_id, keys, values):
81:        self.cache.set_item_values(table, item_id, keys, values, connection=self.open_connection)
82-
83-    # ============================================
84-    # Multiple items with multiple key/value pairs
85-    # ============================================
86-
87-    def get_cached_list_values(self, table, keys, values, conditions):
88:        return self.cache.get_list_values(table, keys, values, conditions, connection=self.open_connection)
89-
90-    def set_cached_list_values(self, table, keys, values, overwrite=False):
91:        self.cache.set_list_values(table, keys, values, overwrite=overwrite, connection=self.open_connection)
92-
93-    def set_or_update_null_cached_list_values(self, table, keys, values, conflict_constraint='id'):
94:        self.cache.set_or_update_null_list_values(table, keys, values, conflict_constraint=conflict_constraint, connection=self.open_connection)
95-
96-    def set_cached_many(self, table, keys, data):
97:        self.cache.set_many_values(table, keys, data, connection=self.open_connection)
98-
99-    def use_cached_many(self, table, keys, values, conditions, func, *args, **kwargs):
100-        internal_data = self.get_cached_list_values(table, keys, values, conditions)
101-
102-        def get_external_data():
```

### Connection usage in resources/tmdbhelper/lib/files/dbdata.py:
```python
62-
63-    def check_database_initialization(self):
64-        if not self.database_initialized:
65-            self.init_database()
66-
67:    def set_pragmas(self, connection):
68:        cursor = connection.cursor()
69-        cursor.execute("PRAGMA synchronous=NORMAL")
70-        cursor.execute("PRAGMA journal_mode=WAL")
71-        cursor.execute("PRAGMA foreign_keys=ON")
72:        return connection
73-
74-    def init_database(self):
75-        from jurialmunkey.locker import MutexPropLock
76-        with MutexPropLock(f'{self._db_file}.lockfile', kodi_log=self.kodi_log):
77-            database = self.create_database()
--
80-
81-    def create_database(self):
82-        try:
83-            with TimerFunc(f'CACHE: Initialisation {self._db_file} took:'):
84-                self.kodi_log(f'CACHE: Initialising...\n{self._db_file}\n{self._sc_name}', 1)
85:                connection = sqlite3.connect(self._db_file, timeout=self._db_timeout)
86:                connection = self.set_pragmas(connection)
87:                connection = self.create_database_execute(connection)
88:            return connection
89-        except Exception as error:
90-            self.kodi_log(f'CACHE: Exception while initializing _database: {error}\n{self._sc_name}', 1)
91-
92-    def get_database(self, read_only=False, log_level=1):
93-        timeout = self._db_read_timeout if read_only else self._db_timeout
94-        try:
95:            connection = sqlite3.connect(self._db_file, timeout=timeout)
96-        except Exception as error:
97-            self.kodi_log(f'CACHE: ERROR while retrieving _database: {error}\n{self._sc_name}', log_level)
98-            return None
99:        connection.row_factory = sqlite3.Row
100:        return self.set_pragmas(connection)
101-
102:    def database_execute(self, connection, query, data=None):
103-        try:
104-            if not data:
105:                return connection.execute(query)
106-            if isinstance(data, list):
107:                return connection.executemany(query, data)
108:            return connection.execute(query, data)
109-        except sqlite3.OperationalError as operational_exception:
110-            self.kodi_log(f'CACHE: database OPERATIONAL ERROR! -- {operational_exception}\n{self._sc_name}\n--query--\n{query}\n--data--\n{data}', 2)
111-        except Exception as other_exception:
112-            self.kodi_log(f'CACHE: database OTHER ERROR! -- {other_exception}\n{self._sc_name}\n--query--\n{query}\n--data--\n{data}', 2)
113-
114:    def execute_sql(self, query, data=None, read_only=False, connection=None):
115-        try:
116:            if connection:
117:                return self.database_execute(connection, query, data=data)
118-            with self.get_database(read_only=read_only) as conn:
119-                return self.database_execute(conn, query, data=data)
120-        except Exception as database_exception:
121-            self.kodi_log(f'CACHE: database GET DATABASE ERROR! -- {database_exception}\n{self._sc_name} -- read_only: {read_only}', 2)
122-
123-    @property
124-    def database_tables(self):
125-        return {}
126-
127:    def create_database_execute(self, connection):
128-        def create_column_data(columns):
129-            return [f'{k} {v["data"]}' for k, v in columns.items()]
130-        
131-        def create_column_fkey(columns):
132-            return [f'FOREIGN KEY({k}) REFERENCES {v["foreign_key"]} ON DELETE CASCADE' for k, v in columns.items() if 'foreign_key' in v]
133-
134-        def create_column_uids(columns):
135-            keys = [k for k, v in columns.items() if v.get('unique')]
136-            return [f'UNIQUE ({", ".join(keys)})'] if keys else []
137-
138:        cursor = connection.cursor()
139-        this_database_version = cursor.execute("PRAGMA user_version").fetchone()[0]
140-
141-        if this_database_version and this_database_version < self.database_version:
142-            for version, changes in self.database_changes.items():
143-                if version <= this_database_version: continue
--
162-            try:
163-                query = f"PRAGMA user_version = {self.database_version}"
164-                cursor.execute(query)
165-            except Exception as error: self.kodi_log(f'CACHE: Exception while initializing _database: {error}\n{self._sc_name} - {query}', 1)
166-
167:        return connection
168-
169-
170-class DatabaseStatements:
171-    @staticmethod
172-    def insert_or_ignore(table, keys=('id',)):
--
205-        conditions_str = f' WHERE {conditions}' if conditions else ''
206-        return f"SELECT {', '.join(keys)} FROM {table}{conditions_str}"
207-
208-
209-class DatabaseMethod:
210:    def set_list_values(self, table=DEFAULT_TABLE, keys=(), values=(), overwrite=False, connection=None):
211-        if not values: return
212-        statement = DatabaseStatements.insert_or_replace if overwrite else DatabaseStatements.insert_or_ignore
213:        self.execute_sql(statement(table, keys), values, connection=connection)
214-
215:    def get_list_values(self, table=DEFAULT_TABLE, keys=(), values=(), conditions=None, connection=None):
216:        cursor = self.execute_sql(DatabaseStatements.select(table, keys, conditions), data=values, read_only=True, connection=connection)
217-        return cursor.fetchall() if cursor else None
218-
219:    def del_list_values(self, table=DEFAULT_TABLE, values=(), conditions=None, connection=None):
220:        self.execute_sql(DatabaseStatements.delete_item(table, conditions), data=values, connection=connection)
221-
222:    def set_or_update_null_list_values(self, table=DEFAULT_TABLE, keys=(), values=(), conflict_constraint='id', connection=None):
223-        if not values: return
224-        statement = DatabaseStatements.insert_or_update_if_null
225:        self.execute_sql(statement(table, keys, conflict_constraint=conflict_constraint), values, connection=connection)
226-
227:    def get_values(self, table=DEFAULT_TABLE, item_id=None, keys=(), connection=None):
228:        cursor = self.execute_sql(DatabaseStatements.select_limit(table, keys), data=(item_id,), read_only=True, connection=connection)
229-        return cursor.fetchone() if cursor else None
230-
231:    def set_item_values(self, table=DEFAULT_TABLE, item_id=None, keys=(), values=(), connection=None):
232-        def _transaction(conn):
233:            self.create_item(table=table, item_id=item_id, connection=conn)
234:            self.execute_sql(DatabaseStatements.update_if_null(table, keys), data=(*values, item_id), connection=conn)
235-        
236:        if connection: _transaction(connection)
237-        else:
238-            with self.get_database() as conn: _transaction(conn)
239-
240:    def set_many_values(self, table=DEFAULT_TABLE, keys=(), data=None, connection=None):
241-        if not data: return
242-        def _transaction(conn):
243:            self.create_many_items(table=table, item_ids=list(data.keys()), connection=conn)
244:            self.execute_sql(DatabaseStatements.update_if_null(table, keys), data=[(*values, item_id) for item_id, values in data.items()], connection=conn)
245-
246:        if connection: _transaction(connection)
247-        else:
248-            with self.get_database() as conn: _transaction(conn)
249-
250:    def del_column_values(self, table=DEFAULT_TABLE, keys=(), item_type=None, connection=None):
251-        conditions = 'item_type=?' if item_type is not None else None
252-        data = (item_type,) if item_type is not None else None
253:        self.execute_sql(DatabaseStatements.delete_keys(table, keys, conditions=conditions), data=data, connection=connection)
254-
255:    def del_item(self, table=DEFAULT_TABLE, item_id=None, connection=None):
256:        self.execute_sql(DatabaseStatements.delete_item(table), data=(item_id,), connection=connection)
257-
258:    def del_item_like(self, table=DEFAULT_TABLE, item_id=None, connection=None):
259:        self.execute_sql(DatabaseStatements.delete_item(table, conditions='id LIKE ?'), data=(item_id,), connection=connection)
260-
261:    def create_item(self, table=DEFAULT_TABLE, item_id=None, connection=None):
262:        self.execute_sql(DatabaseStatements.insert_or_ignore(table), data=(item_id,), connection=connection)
263-
264:    def create_many_items(self, table=DEFAULT_TABLE, item_ids=(), connection=None):
265-        if not item_ids: return
266:        self.execute_sql(DatabaseStatements.insert_or_ignore(table), data=[(item_id,) for item_id in item_ids], connection=connection)
267-
268-
269-class Database(DatabaseCore, DatabaseMethod):
270-    pass
```

## Optimization Recommendations

### High Priority Optimizations:

